# Системные Паттерны: SQLRC (Pascal)

Этот документ описывает основные архитектурные и дизайнерские паттерны, применяемые в проекте SQLRC на Pascal.

## 1. Модульная Структура
**Описание:** Проект разделен на логические модули (units в терминах Pascal), каждый из которых отвечает за определенную часть функциональности.
**Примеры:**
- `fs.pas`: Работа с файловой системой (чтение конфигурации, чтение/запись SQL и Go файлов).
- `types.pas`: Определение общих типов данных (TConfig, TSchema, TQueryToken и т.д.).
- `parse/`: Модули, отвечающие за парсинг (schema.pas, query/parse.pas, query/params.pas, query/result.pas).
- `generate/`: Модули, отвечающие за генерацию кода Go (schema.pas, query.pas, return/one.pas и т.д.).
- `sqlrc.dpr`: Главный модуль, координирующий работу остальных модулей.
**Преимущества:** Улучшение организации кода, переиспользуемость, упрощение поддержки и тестирования отдельных частей.

## 2. Использование Записей (Records) для Структур Данных
**Описание:** Для представления структурированных данных (конфигурация, элементы схемы SQL, токены запросов, параметры, результаты) активно используются записи (`record`) Pascal.
**Примеры:** `TConfig`, `TPackage`, `TColumn`, `TTableColumns`, `TSchema`, `TQueryToken`, `TQueryParam`, `TParamedQuery`, `TResolvedReturnQuery`.
**Преимущества:** Строгая типизация, инкапсуляция связанных данных, понятность структуры данных.

## 3. Процедурный Подход к Основной Логике
**Описание:** Основная логика парсинга и генерации реализована с использованием процедур и функций.
**Примеры:** `ParseSchema`, `GenerateSchema`, `ParseQueries`, `ParseQueryParams`, `GenerateQueryFile`, `GetConfig`, `GetCodes`.
**Преимущества:** Простота реализации для данной задачи, ясность потока выполнения.
**Ограничения:** Может привести к усложнению при значительном росте функциональности по сравнению с ООП подходом.

## 4. Парсинг Конфигурации "Ключ-Значение"
**Описание:** Для конфигурационного файла используется простой текстовый формат `key:value`, который парсится построчно с разделением по символу `:`.
**Пример:** Функция `GetConfig` в `fs.pas` (или аналогичная логика).
**Преимущества:** Простота реализации парсера без внешних зависимостей.
**Ограничения:** Не подходит для сложных, вложенных конфигураций.

## 5. Парсинг SQL с Помощью Строковых Функций
**Описание:** Вместо регулярных выражений (отсутствующих в стандартной библиотеке) для анализа SQL-кода используются встроенные функции Pascal для работы со строками (`Pos`, `Copy`, `Trim`, `Delete` и т.д.).
**Примеры:** Логика в модулях `parse/schema.pas`, `parse/query/parse.pas`, `parse/query/params.pas`.
**Преимущества:** Отсутствие внешних зависимостей.
**Ограничения:** Повышенная сложность и хрупкость кода парсера по сравнению с regex, особенно при расширении поддерживаемого синтаксиса SQL.

*(Примечание: Этот файл следует обновлять при появлении или изменении используемых паттернов.)*
