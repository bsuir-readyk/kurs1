# Модули проекта SQLRC

## Основные модули

1. **Главный модуль (sqlrc.dpr)**
   - Точка входа в приложение
   - Координирует работу всех модулей
   - Обрабатывает аргументы командной строки
   - Управляет процессом генерации кода

2. **Модуль типов данных (src/types.pas)**
   - Определяет все типы данных, используемые в проекте
   - Содержит структуры для конфигурации, схемы, запросов
   - Предоставляет функции для преобразования типов

3. **Модуль файловой системы (src/fs.pas)**
   - Отвечает за чтение и запись файлов
   - Обрабатывает конфигурационный файл
   - Создает директории для сгенерированных файлов
   - Записывает сгенерированный код в файлы

## Модули парсинга

4. **Парсер схемы (src/parse/schema.pas)**
   - Анализирует SQL-файл с определениями таблиц (CREATE TABLE)
   - Извлекает имена таблиц и их структуру
   - Определяет типы полей и их атрибуты
   - Обрабатывает комментарии в SQL-коде

5. **Парсер запросов (src/parse/query/parse.pas)**
   - Анализирует SQL-файл с запросами
   - Распознает специальные комментарии формата `--@ sqlrc:ИмяФункции:ТипВозврата`
   - Разделяет файл на отдельные запросы
   - Определяет имена и типы запросов

6. **Парсер параметров запросов (src/parse/query/params.pas)**
   - Анализирует параметры запросов в формате `<@имя_параметра:тип_параметра@>`
   - Определяет имена и типы параметров
   - Обрабатывает повторяющиеся параметры
   - Заменяет параметры на плейсхолдеры в SQL-запросах

7. **Парсер результатов запросов (src/parse/query/result.pas)**
   - Анализирует результаты запросов для определения структуры возвращаемых данных
   - Связывает поля результатов с полями таблиц
   - Определяет типы возвращаемых значений

## Модули генерации

8. **Генератор схемы (src/generate/schema.pas)**
   - Генерирует Go-код с определениями структур данных для таблиц
   - Создает структуру `Queries` с полем `DB` типа `*sql.DB`
   - Преобразует типы данных SQL в типы Go
   - Добавляет теги `db` к полям структур

9. **Генератор запросов (src/generate/query.pas)**
   - Генерирует Go-код с функциями для выполнения запросов
   - Создает константы с SQL-запросами
   - Генерирует структуры для параметров запросов
   - Координирует работу генераторов для разных типов запросов

10. **Генератор для запросов типа "one" (src/generate/return/one.pas)**
    - Генерирует функции для запросов, возвращающих одну запись
    - Создает структуры для результатов запросов
    - Генерирует код для сканирования результатов запроса

11. **Генератор для запросов типа "many" (src/generate/return/many.pas)**
    - Генерирует функции для запросов, возвращающих несколько записей
    - Создает структуры для результатов запросов
    - Генерирует код для итерации по результатам запроса

12. **Генератор для запросов типа "exec" (src/generate/return/exec.pas)**
    - Генерирует функции для запросов, не возвращающих данные (INSERT, UPDATE, DELETE)
    - Генерирует код для выполнения запросов и обработки результатов
